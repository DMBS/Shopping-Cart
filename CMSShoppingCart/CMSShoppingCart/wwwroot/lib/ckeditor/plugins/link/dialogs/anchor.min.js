CKEDITOR.dialog.add("anchor",function(l){function n(e,t){return e.createFakeElement(e.document.createElement("a",{attributes:t}),"cke_anchor","anchor")}return{title:l.lang.link.anchor.title,minWidth:300,minHeight:60,getModel:function(e){var t=e.getSelection();return e=t.getRanges()[0],t=t.getSelectedElement(),e.shrink(CKEDITOR.SHRINK_ELEMENT),(e=(t=(t=e.getEnclosedNode())&&t.type===CKEDITOR.NODE_TEXT?t.getParent():t)&&t.type===CKEDITOR.NODE_ELEMENT&&("anchor"===t.data("cke-real-element-type")||t.is("a"))?t:void 0)||null},onOk:function(){var e={id:e=CKEDITOR.tools.trim(this.getValueOf("info","txtName")),name:e,"data-cke-saved-name":e},t=this.getModel(l);t?t.data("cke-realelement")?((e=n(l,e)).replace(t),CKEDITOR.env.ie&&l.getSelection().selectElement(e)):t.setAttributes(e):(t=(t=l.getSelection())&&t.getRanges()[0]).collapsed?(e=n(l,e),t.insertNode(e)):(CKEDITOR.env.ie&&CKEDITOR.env.version<9&&(e.class="cke_anchor"),(e=new CKEDITOR.style({element:"a",attributes:e})).type=CKEDITOR.STYLE_INLINE,e.applyToRange(t))},onShow:function(){var e,t=l.getSelection(),n=this.getModel(l),a=n&&n.data("cke-realelement");(n=a?CKEDITOR.plugins.link.tryRestoreFakeAnchor(l,n):CKEDITOR.plugins.link.getSelectedLink(l))&&(e=n.data("cke-saved-name"),this.setValueOf("info","txtName",e||""),a||t.selectElement(n)),this.getContentElement("info","txtName").focus()},contents:[{id:"info",label:l.lang.link.anchor.title,accessKey:"I",elements:[{type:"text",id:"txtName",label:l.lang.link.anchor.name,required:!0,validate:function(){return!!this.getValue()||(alert(l.lang.link.anchor.errorName),!1)}}]}]}});